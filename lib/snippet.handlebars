
(function(win, doc){

  /**
   * Vars.
   */

  var analytics = win.analytics = win.analytics || [];
  var secure = 'https:' == win.location.protocol;

  /**
   * Version.
   */

  analytics.SNIPPET_VERSION = '3.0.0';

  /**
   * A list of our methods.
   */

  analytics.methods = [
    'trackSubmit',
    'trackClick',
    'trackLink',
    'trackForm',
    'pageview',
    'identify',
    'track',
    'group',
    'alias',
    'ready',
    'page',
    'once',
    'off',
    'on',
  ];

  /**
   * Create a queue for method `name`.
   * 
   * @param {String} name
   * @return {Function}
   */

  function queue(name){
    return function(){
      var args = [].slice.call(arguments);
      analytics.push([name].concat(args));
      return analytics;
    };
  }

  /**
   * Create the methods.
   */

  for (var i = 0, m; m = analytics.methods[i++];) {
    analytics[m] = queue(m);
  }

  /**
   * Load the script.
   */

  var script = doc.createElement('script');
  var scripts = doc.getElementsByTagName('script');
  script.type = 'text/javascript';
  script.async = true;
  script.src = (secure ? 'https://' : 'http://')
    + '{{{ host }}}/analytics.js/v1/'
    + '{{{ apiKey }}}/analytics.min.js';

  /**
   * Append.
   */

  scripts[0].parentNode.insertBefore(script);

})(window, document);
